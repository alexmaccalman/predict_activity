predict\_activity
================
Alex MacCalman
9/8/2020

This project develops a prediction model to predict whether a person
lifts a barbell correctly or incorrectly in 5 different ways. More
information is available from the website
[here:](http://groupware.les.inf.puc-rio.br/har%20\(see%20the%20section%20on%20the%20Weight%20Lifting%20Exercise%20Dataset\)).

# Load and explore the data.

``` r
data_raw <- read_csv("https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv")
```

    ## Warning: Missing column names filled in: 'X1' [1]

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_double(),
    ##   user_name = col_character(),
    ##   cvtd_timestamp = col_character(),
    ##   new_window = col_character(),
    ##   kurtosis_roll_belt = col_character(),
    ##   kurtosis_picth_belt = col_character(),
    ##   kurtosis_yaw_belt = col_character(),
    ##   skewness_roll_belt = col_character(),
    ##   skewness_roll_belt.1 = col_character(),
    ##   skewness_yaw_belt = col_character(),
    ##   max_yaw_belt = col_character(),
    ##   min_yaw_belt = col_character(),
    ##   amplitude_yaw_belt = col_character(),
    ##   kurtosis_picth_arm = col_character(),
    ##   kurtosis_yaw_arm = col_character(),
    ##   skewness_pitch_arm = col_character(),
    ##   skewness_yaw_arm = col_character(),
    ##   kurtosis_yaw_dumbbell = col_character(),
    ##   skewness_yaw_dumbbell = col_character(),
    ##   kurtosis_roll_forearm = col_character(),
    ##   kurtosis_picth_forearm = col_character()
    ##   # ... with 8 more columns
    ## )

    ## See spec(...) for full column specifications.

    ## Warning: 182 parsing failures.
    ##  row               col expected  actual                                                                   file
    ## 2231 kurtosis_roll_arm a double #DIV/0! 'https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv'
    ## 2231 skewness_roll_arm a double #DIV/0! 'https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv'
    ## 2255 kurtosis_roll_arm a double #DIV/0! 'https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv'
    ## 2255 skewness_roll_arm a double #DIV/0! 'https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv'
    ## 2282 kurtosis_roll_arm a double #DIV/0! 'https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv'
    ## .... ................. ........ ....... ......................................................................
    ## See problems(...) for more details.

``` r
valid_raw <- read_csv("https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv")
```

    ## Warning: Missing column names filled in: 'X1' [1]

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_logical(),
    ##   X1 = col_double(),
    ##   user_name = col_character(),
    ##   raw_timestamp_part_1 = col_double(),
    ##   raw_timestamp_part_2 = col_double(),
    ##   cvtd_timestamp = col_character(),
    ##   new_window = col_character(),
    ##   num_window = col_double(),
    ##   roll_belt = col_double(),
    ##   pitch_belt = col_double(),
    ##   yaw_belt = col_double(),
    ##   total_accel_belt = col_double(),
    ##   gyros_belt_x = col_double(),
    ##   gyros_belt_y = col_double(),
    ##   gyros_belt_z = col_double(),
    ##   accel_belt_x = col_double(),
    ##   accel_belt_y = col_double(),
    ##   accel_belt_z = col_double(),
    ##   magnet_belt_x = col_double(),
    ##   magnet_belt_y = col_double(),
    ##   magnet_belt_z = col_double()
    ##   # ... with 40 more columns
    ## )
    ## See spec(...) for full column specifications.

``` r
#explore data variables
skim((data_raw))
```

|                                                  |             |
| :----------------------------------------------- | :---------- |
| Name                                             | (data\_raw) |
| Number of rows                                   | 19622       |
| Number of columns                                | 160         |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_   |             |
| Column type frequency:                           |             |
| character                                        | 28          |
| numeric                                          | 132         |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ |             |
| Group variables                                  | None        |

Data summary

**Variable type:
character**

| skim\_variable           | n\_missing | complete\_rate | min | max | empty | n\_unique | whitespace |
| :----------------------- | ---------: | -------------: | --: | --: | ----: | --------: | ---------: |
| user\_name               |          0 |           1.00 |   5 |   8 |     0 |         6 |          0 |
| cvtd\_timestamp          |          0 |           1.00 |  16 |  16 |     0 |        20 |          0 |
| new\_window              |          0 |           1.00 |   2 |   3 |     0 |         2 |          0 |
| kurtosis\_roll\_belt     |      19216 |           0.02 |   7 |   9 |     0 |       396 |          0 |
| kurtosis\_picth\_belt    |      19216 |           0.02 |   7 |   9 |     0 |       316 |          0 |
| kurtosis\_yaw\_belt      |      19216 |           0.02 |   7 |   7 |     0 |         1 |          0 |
| skewness\_roll\_belt     |      19216 |           0.02 |   7 |   9 |     0 |       394 |          0 |
| skewness\_roll\_belt.1   |      19216 |           0.02 |   7 |   9 |     0 |       337 |          0 |
| skewness\_yaw\_belt      |      19216 |           0.02 |   7 |   7 |     0 |         1 |          0 |
| max\_yaw\_belt           |      19216 |           0.02 |   3 |   7 |     0 |        67 |          0 |
| min\_yaw\_belt           |      19216 |           0.02 |   3 |   7 |     0 |        67 |          0 |
| amplitude\_yaw\_belt     |      19216 |           0.02 |   4 |   7 |     0 |         3 |          0 |
| kurtosis\_picth\_arm     |      19216 |           0.02 |   7 |   8 |     0 |       327 |          0 |
| kurtosis\_yaw\_arm       |      19216 |           0.02 |   7 |   8 |     0 |       394 |          0 |
| skewness\_pitch\_arm     |      19216 |           0.02 |   7 |   8 |     0 |       327 |          0 |
| skewness\_yaw\_arm       |      19216 |           0.02 |   7 |   8 |     0 |       394 |          0 |
| kurtosis\_yaw\_dumbbell  |      19216 |           0.02 |   7 |   7 |     0 |         1 |          0 |
| skewness\_yaw\_dumbbell  |      19216 |           0.02 |   7 |   7 |     0 |         1 |          0 |
| kurtosis\_roll\_forearm  |      19216 |           0.02 |   6 |   7 |     0 |       321 |          0 |
| kurtosis\_picth\_forearm |      19216 |           0.02 |   6 |   7 |     0 |       322 |          0 |
| kurtosis\_yaw\_forearm   |      19216 |           0.02 |   7 |   7 |     0 |         1 |          0 |
| skewness\_roll\_forearm  |      19216 |           0.02 |   6 |   7 |     0 |       322 |          0 |
| skewness\_pitch\_forearm |      19216 |           0.02 |   6 |   7 |     0 |       318 |          0 |
| skewness\_yaw\_forearm   |      19216 |           0.02 |   7 |   7 |     0 |         1 |          0 |
| max\_yaw\_forearm        |      19216 |           0.02 |   3 |   7 |     0 |        44 |          0 |
| min\_yaw\_forearm        |      19216 |           0.02 |   3 |   7 |     0 |        44 |          0 |
| amplitude\_yaw\_forearm  |      19216 |           0.02 |   4 |   7 |     0 |         2 |          0 |
| classe                   |          0 |           1.00 |   1 |   1 |     0 |         5 |          0 |

**Variable type:
numeric**

| skim\_variable             | n\_missing | complete\_rate |          mean |        sd |            p0 |           p25 |           p50 |           p75 |         p100 | hist  |
| :------------------------- | ---------: | -------------: | ------------: | --------: | ------------: | ------------: | ------------: | ------------: | -----------: | :---- |
| X1                         |          0 |           1.00 |       9811.50 |   5664.53 |   1.00000e+00 |       4906.25 |       9811.50 |      14716.75 | 1.962200e+04 | ▇▇▇▇▇ |
| raw\_timestamp\_part\_1    |          0 |           1.00 | 1322827119.27 | 204927.68 |   1.32249e+09 | 1322673099.00 | 1322832920.00 | 1323084264.00 | 1.323095e+09 | ▃▃▇▁▆ |
| raw\_timestamp\_part\_2    |          0 |           1.00 |     500656.14 | 288222.88 |   2.94000e+02 |     252912.25 |     496380.00 |     751890.75 | 9.988010e+05 | ▇▇▇▇▇ |
| num\_window                |          0 |           1.00 |        430.64 |    247.91 |   1.00000e+00 |        222.00 |        424.00 |        644.00 | 8.640000e+02 | ▇▇▇▇▇ |
| roll\_belt                 |          0 |           1.00 |         64.41 |     62.75 | \-2.89000e+01 |          1.10 |        113.00 |        123.00 | 1.620000e+02 | ▇▁▁▅▅ |
| pitch\_belt                |          0 |           1.00 |          0.31 |     22.35 | \-5.58000e+01 |          1.76 |          5.28 |         14.90 | 6.030000e+01 | ▃▁▇▅▁ |
| yaw\_belt                  |          0 |           1.00 |       \-11.21 |     95.19 | \-1.80000e+02 |       \-88.30 |       \-13.00 |         12.90 | 1.790000e+02 | ▁▇▅▁▃ |
| total\_accel\_belt         |          0 |           1.00 |         11.31 |      7.74 |   0.00000e+00 |          3.00 |         17.00 |         18.00 | 2.900000e+01 | ▇▁▂▆▁ |
| max\_roll\_belt            |      19216 |           0.02 |        \-6.67 |     94.59 | \-9.43000e+01 |       \-88.00 |        \-5.10 |         18.50 | 1.800000e+02 | ▇▅▁▁▃ |
| max\_picth\_belt           |      19216 |           0.02 |         12.92 |      8.01 |   3.00000e+00 |          5.00 |         18.00 |         19.00 | 3.000000e+01 | ▇▁▆▃▁ |
| min\_roll\_belt            |      19216 |           0.02 |       \-10.44 |     93.62 | \-1.80000e+02 |       \-88.40 |        \-7.85 |          9.05 | 1.730000e+02 | ▁▇▅▁▃ |
| min\_pitch\_belt           |      19216 |           0.02 |         10.76 |      7.47 |   0.00000e+00 |          3.00 |         16.00 |         17.00 | 2.300000e+01 | ▇▁▁▇▂ |
| amplitude\_roll\_belt      |      19216 |           0.02 |          3.77 |     25.26 |   0.00000e+00 |          0.30 |          1.00 |          2.08 | 3.600000e+02 | ▇▁▁▁▁ |
| amplitude\_pitch\_belt     |      19216 |           0.02 |          2.17 |      2.36 |   0.00000e+00 |          1.00 |          1.00 |          2.00 | 1.200000e+01 | ▇▁▁▁▁ |
| var\_total\_accel\_belt    |      19216 |           0.02 |          0.93 |      2.22 |   0.00000e+00 |          0.10 |          0.20 |          0.30 | 1.650000e+01 | ▇▁▁▁▁ |
| avg\_roll\_belt            |      19216 |           0.02 |         68.06 |     63.14 | \-2.74000e+01 |          1.10 |        116.35 |        123.38 | 1.574000e+02 | ▇▁▁▃▆ |
| stddev\_roll\_belt         |      19216 |           0.02 |          1.34 |      2.44 |   0.00000e+00 |          0.20 |          0.40 |          0.70 | 1.420000e+01 | ▇▁▁▁▁ |
| var\_roll\_belt            |      19216 |           0.02 |          7.70 |     23.16 |   0.00000e+00 |          0.00 |          0.10 |          0.50 | 2.007000e+02 | ▇▁▁▁▁ |
| avg\_pitch\_belt           |      19216 |           0.02 |          0.52 |     22.41 | \-5.14000e+01 |          2.02 |          5.20 |         15.78 | 5.970000e+01 | ▃▁▇▃▁ |
| stddev\_pitch\_belt        |      19216 |           0.02 |          0.60 |      0.64 |   0.00000e+00 |          0.20 |          0.40 |          0.70 | 4.000000e+00 | ▇▁▁▁▁ |
| var\_pitch\_belt           |      19216 |           0.02 |          0.77 |      1.76 |   0.00000e+00 |          0.00 |          0.10 |          0.50 | 1.620000e+01 | ▇▁▁▁▁ |
| avg\_yaw\_belt             |      19216 |           0.02 |        \-8.83 |     93.48 | \-1.38300e+02 |       \-88.18 |        \-6.55 |         14.12 | 1.735000e+02 | ▇▁▅▁▃ |
| stddev\_yaw\_belt          |      19216 |           0.02 |          1.34 |     10.29 |   0.00000e+00 |          0.10 |          0.30 |          0.70 | 1.766000e+02 | ▇▁▁▁▁ |
| var\_yaw\_belt             |      19216 |           0.02 |        107.49 |   1655.52 |   0.00000e+00 |          0.01 |          0.09 |          0.48 | 3.118324e+04 | ▇▁▁▁▁ |
| gyros\_belt\_x             |          0 |           1.00 |        \-0.01 |      0.21 | \-1.04000e+00 |        \-0.03 |          0.03 |          0.11 | 2.220000e+00 | ▁▇▁▁▁ |
| gyros\_belt\_y             |          0 |           1.00 |          0.04 |      0.08 | \-6.40000e-01 |          0.00 |          0.02 |          0.11 | 6.400000e-01 | ▁▁▇▁▁ |
| gyros\_belt\_z             |          0 |           1.00 |        \-0.13 |      0.24 | \-1.46000e+00 |        \-0.20 |        \-0.10 |        \-0.02 | 1.620000e+00 | ▁▂▇▁▁ |
| accel\_belt\_x             |          0 |           1.00 |        \-5.59 |     29.64 | \-1.20000e+02 |       \-21.00 |       \-15.00 |        \-5.00 | 8.500000e+01 | ▁▁▇▁▂ |
| accel\_belt\_y             |          0 |           1.00 |         30.15 |     28.58 | \-6.90000e+01 |          3.00 |         35.00 |         61.00 | 1.640000e+02 | ▁▇▇▁▁ |
| accel\_belt\_z             |          0 |           1.00 |       \-72.59 |    100.45 | \-2.75000e+02 |      \-162.00 |      \-152.00 |         27.00 | 1.050000e+02 | ▁▇▁▅▃ |
| magnet\_belt\_x            |          0 |           1.00 |         55.60 |     64.18 | \-5.20000e+01 |          9.00 |         35.00 |         59.00 | 4.850000e+02 | ▇▁▂▁▁ |
| magnet\_belt\_y            |          0 |           1.00 |        593.68 |     35.68 |   3.54000e+02 |        581.00 |        601.00 |        610.00 | 6.730000e+02 | ▁▁▁▇▃ |
| magnet\_belt\_z            |          0 |           1.00 |      \-345.48 |     65.21 | \-6.23000e+02 |      \-375.00 |      \-320.00 |      \-306.00 | 2.930000e+02 | ▁▇▁▁▁ |
| roll\_arm                  |          0 |           1.00 |         17.83 |     72.74 | \-1.80000e+02 |       \-31.78 |          0.00 |         77.30 | 1.800000e+02 | ▁▃▇▆▂ |
| pitch\_arm                 |          0 |           1.00 |        \-4.61 |     30.68 | \-8.88000e+01 |       \-25.90 |          0.00 |         11.20 | 8.850000e+01 | ▁▅▇▂▁ |
| yaw\_arm                   |          0 |           1.00 |        \-0.62 |     71.36 | \-1.80000e+02 |       \-43.10 |          0.00 |         45.88 | 1.800000e+02 | ▁▃▇▃▂ |
| total\_accel\_arm          |          0 |           1.00 |         25.51 |     10.52 |   1.00000e+00 |         17.00 |         27.00 |         33.00 | 6.600000e+01 | ▃▆▇▁▁ |
| var\_accel\_arm            |      19216 |           0.02 |         53.24 |     53.98 |   0.00000e+00 |          9.03 |         40.61 |         75.62 | 3.317000e+02 | ▇▂▁▁▁ |
| avg\_roll\_arm             |      19216 |           0.02 |         12.68 |     68.58 | \-1.66670e+02 |       \-38.37 |          0.00 |         76.32 | 1.633300e+02 | ▁▅▇▅▃ |
| stddev\_roll\_arm          |      19216 |           0.02 |         11.20 |     17.10 |   0.00000e+00 |          1.38 |          5.70 |         14.92 | 1.619600e+02 | ▇▁▁▁▁ |
| var\_roll\_arm             |      19216 |           0.02 |        417.26 |   2007.16 |   0.00000e+00 |          1.90 |         32.52 |        222.65 | 2.623221e+04 | ▇▁▁▁▁ |
| avg\_pitch\_arm            |      19216 |           0.02 |        \-4.90 |     26.83 | \-8.17700e+01 |       \-22.77 |          0.00 |          8.28 | 7.566000e+01 | ▁▃▇▂▁ |
| stddev\_pitch\_arm         |      19216 |           0.02 |         10.38 |      9.40 |   0.00000e+00 |          1.64 |          8.13 |         16.33 | 4.341000e+01 | ▇▅▂▁▁ |
| var\_pitch\_arm            |      19216 |           0.02 |        195.86 |    292.60 |   0.00000e+00 |          2.70 |         66.15 |        266.58 | 1.884560e+03 | ▇▁▁▁▁ |
| avg\_yaw\_arm              |      19216 |           0.02 |          2.36 |     61.33 | \-1.73440e+02 |       \-29.20 |          0.00 |         38.18 | 1.520000e+02 | ▁▂▇▃▂ |
| stddev\_yaw\_arm           |      19216 |           0.02 |         22.27 |     23.69 |   0.00000e+00 |          2.58 |         16.68 |         35.98 | 1.770400e+02 | ▇▂▁▁▁ |
| var\_yaw\_arm              |      19216 |           0.02 |       1055.93 |   2722.17 |   0.00000e+00 |          6.64 |        278.31 |       1294.85 | 3.134457e+04 | ▇▁▁▁▁ |
| gyros\_arm\_x              |          0 |           1.00 |          0.04 |      1.99 | \-6.37000e+00 |        \-1.33 |          0.08 |          1.57 | 4.870000e+00 | ▁▃▇▆▂ |
| gyros\_arm\_y              |          0 |           1.00 |        \-0.26 |      0.85 | \-3.44000e+00 |        \-0.80 |        \-0.24 |          0.14 | 2.840000e+00 | ▁▂▇▂▁ |
| gyros\_arm\_z              |          0 |           1.00 |          0.27 |      0.55 | \-2.33000e+00 |        \-0.07 |          0.23 |          0.72 | 3.020000e+00 | ▁▂▇▂▁ |
| accel\_arm\_x              |          0 |           1.00 |       \-60.24 |    182.04 | \-4.04000e+02 |      \-242.00 |       \-44.00 |         84.00 | 4.370000e+02 | ▇▅▇▅▁ |
| accel\_arm\_y              |          0 |           1.00 |         32.60 |    109.87 | \-3.18000e+02 |       \-54.00 |         14.00 |        139.00 | 3.080000e+02 | ▁▃▇▆▂ |
| accel\_arm\_z              |          0 |           1.00 |       \-71.25 |    134.65 | \-6.36000e+02 |      \-143.00 |       \-47.00 |         23.00 | 2.920000e+02 | ▁▁▅▇▁ |
| magnet\_arm\_x             |          0 |           1.00 |        191.72 |    443.64 | \-5.84000e+02 |      \-300.00 |        289.00 |        637.00 | 7.820000e+02 | ▆▃▂▃▇ |
| magnet\_arm\_y             |          0 |           1.00 |        156.61 |    201.91 | \-3.92000e+02 |        \-9.00 |        202.00 |        323.00 | 5.830000e+02 | ▁▅▅▇▂ |
| magnet\_arm\_z             |          0 |           1.00 |        306.49 |    326.62 | \-5.97000e+02 |        131.25 |        444.00 |        545.00 | 6.940000e+02 | ▁▂▂▃▇ |
| kurtosis\_roll\_arm        |      19294 |           0.02 |        \-0.37 |      2.05 | \-1.81000e+00 |        \-1.35 |        \-0.89 |        \-0.04 | 2.146000e+01 | ▇▁▁▁▁ |
| skewness\_roll\_arm        |      19293 |           0.02 |          0.07 |      0.91 | \-2.54000e+00 |        \-0.56 |          0.04 |          0.67 | 4.390000e+00 | ▁▇▆▁▁ |
| max\_roll\_arm             |      19216 |           0.02 |         11.24 |     26.93 | \-7.31000e+01 |        \-0.18 |          4.95 |         26.78 | 8.550000e+01 | ▁▂▇▃▁ |
| max\_picth\_arm            |      19216 |           0.02 |         35.75 |     69.62 | \-1.73000e+02 |        \-1.98 |         23.25 |         95.97 | 1.800000e+02 | ▁▂▇▆▃ |
| max\_yaw\_arm              |      19216 |           0.02 |         35.46 |     10.45 |   4.00000e+00 |         29.00 |         34.00 |         41.00 | 6.500000e+01 | ▁▂▇▃▁ |
| min\_roll\_arm             |      19216 |           0.02 |       \-21.22 |     28.72 | \-8.91000e+01 |       \-41.98 |       \-22.45 |          0.00 | 6.640000e+01 | ▂▆▇▂▁ |
| min\_pitch\_arm            |      19216 |           0.02 |       \-33.92 |     60.83 | \-1.80000e+02 |       \-72.62 |       \-33.85 |          0.00 | 1.520000e+02 | ▁▆▇▂▁ |
| min\_yaw\_arm              |      19216 |           0.02 |         14.67 |      9.11 |   1.00000e+00 |          8.00 |         13.00 |         19.00 | 3.800000e+01 | ▆▇▃▂▂ |
| amplitude\_roll\_arm       |      19216 |           0.02 |         32.45 |     27.39 |   0.00000e+00 |          5.43 |         28.45 |         50.96 | 1.195000e+02 | ▇▆▃▁▁ |
| amplitude\_pitch\_arm      |      19216 |           0.02 |         69.68 |     66.98 |   0.00000e+00 |          9.93 |         54.90 |        115.17 | 3.600000e+02 | ▇▅▂▁▁ |
| amplitude\_yaw\_arm        |      19216 |           0.02 |         20.79 |     12.28 |   0.00000e+00 |         13.00 |         22.00 |         28.75 | 5.200000e+01 | ▅▅▇▃▁ |
| roll\_dumbbell             |          0 |           1.00 |         23.84 |     69.93 | \-1.53710e+02 |       \-18.49 |         48.17 |         67.61 | 1.535500e+02 | ▂▂▃▇▂ |
| pitch\_dumbbell            |          0 |           1.00 |       \-10.78 |     36.99 | \-1.49590e+02 |       \-40.89 |       \-20.96 |         17.50 | 1.494000e+02 | ▁▆▇▂▁ |
| yaw\_dumbbell              |          0 |           1.00 |          1.67 |     82.52 | \-1.50870e+02 |       \-77.64 |        \-3.32 |         79.64 | 1.549500e+02 | ▃▇▅▅▆ |
| kurtosis\_roll\_dumbbell   |      19221 |           0.02 |          0.45 |      3.19 | \-2.17000e+00 |        \-0.68 |        \-0.03 |          0.94 | 5.500000e+01 | ▇▁▁▁▁ |
| kurtosis\_picth\_dumbbell  |      19218 |           0.02 |          0.29 |      3.30 | \-2.20000e+00 |        \-0.72 |        \-0.13 |          0.58 | 5.563000e+01 | ▇▁▁▁▁ |
| skewness\_roll\_dumbbell   |      19220 |           0.02 |        \-0.12 |      0.82 | \-7.38000e+00 |        \-0.58 |        \-0.08 |          0.40 | 1.960000e+00 | ▁▁▁▇▆ |
| skewness\_pitch\_dumbbell  |      19217 |           0.02 |        \-0.03 |      0.86 | \-7.45000e+00 |        \-0.53 |        \-0.09 |          0.51 | 3.770000e+00 | ▁▁▂▇▁ |
| max\_roll\_dumbbell        |      19216 |           0.02 |         13.76 |     48.30 | \-7.01000e+01 |       \-27.15 |         14.85 |         50.58 | 1.370000e+02 | ▆▇▇▅▂ |
| max\_picth\_dumbbell       |      19216 |           0.02 |         32.75 |     93.37 | \-1.12900e+02 |       \-66.70 |         40.05 |        133.23 | 1.550000e+02 | ▆▃▂▂▇ |
| max\_yaw\_dumbbell         |      19221 |           0.02 |          0.45 |      3.19 | \-2.20000e+00 |        \-0.70 |          0.00 |          0.90 | 5.500000e+01 | ▇▁▁▁▁ |
| min\_roll\_dumbbell        |      19216 |           0.02 |       \-41.24 |     34.71 | \-1.49600e+02 |       \-59.68 |       \-43.55 |       \-25.20 | 7.320000e+01 | ▁▃▇▃▁ |
| min\_pitch\_dumbbell       |      19216 |           0.02 |       \-33.18 |     74.28 | \-1.47000e+02 |       \-91.80 |       \-66.15 |         21.20 | 1.209000e+02 | ▆▇▅▃▃ |
| min\_yaw\_dumbbell         |      19221 |           0.02 |          0.45 |      3.19 | \-2.20000e+00 |        \-0.70 |          0.00 |          0.90 | 5.500000e+01 | ▇▁▁▁▁ |
| amplitude\_roll\_dumbbell  |      19216 |           0.02 |         55.00 |     54.94 |   0.00000e+00 |         14.97 |         35.05 |         81.04 | 2.564800e+02 | ▇▂▁▁▁ |
| amplitude\_pitch\_dumbbell |      19216 |           0.02 |         65.93 |     65.23 |   0.00000e+00 |         17.06 |         41.72 |         99.54 | 2.735900e+02 | ▇▂▂▁▁ |
| amplitude\_yaw\_dumbbell   |      19221 |           0.02 |          0.00 |      0.00 |   0.00000e+00 |          0.00 |          0.00 |          0.00 | 0.000000e+00 | ▁▁▇▁▁ |
| total\_accel\_dumbbell     |          0 |           1.00 |         13.72 |     10.23 |   0.00000e+00 |          4.00 |         10.00 |         19.00 | 5.800000e+01 | ▇▅▃▁▁ |
| var\_accel\_dumbbell       |      19216 |           0.02 |          4.39 |     13.51 |   0.00000e+00 |          0.38 |          1.00 |          3.43 | 2.304300e+02 | ▇▁▁▁▁ |
| avg\_roll\_dumbbell        |      19216 |           0.02 |         23.86 |     62.90 | \-1.28960e+02 |       \-12.33 |         48.23 |         64.37 | 1.259900e+02 | ▂▂▃▇▂ |
| stddev\_roll\_dumbbell     |      19216 |           0.02 |         20.76 |     24.30 |   0.00000e+00 |          4.64 |         12.20 |         26.36 | 1.237800e+02 | ▇▂▁▁▁ |
| var\_roll\_dumbbell        |      19216 |           0.02 |       1020.27 |   2262.56 |   0.00000e+00 |         21.52 |        148.95 |        694.65 | 1.532101e+04 | ▇▁▁▁▁ |
| avg\_pitch\_dumbbell       |      19216 |           0.02 |       \-12.33 |     32.06 | \-7.07300e+01 |       \-42.00 |       \-19.90 |         13.21 | 9.428000e+01 | ▇▇▇▂▁ |
| stddev\_pitch\_dumbbell    |      19216 |           0.02 |         13.15 |     13.34 |   0.00000e+00 |          3.48 |          8.09 |         19.24 | 8.268000e+01 | ▇▂▁▁▁ |
| var\_pitch\_dumbbell       |      19216 |           0.02 |        350.31 |    673.96 |   0.00000e+00 |         12.13 |         65.43 |        370.11 | 6.836020e+03 | ▇▁▁▁▁ |
| avg\_yaw\_dumbbell         |      19216 |           0.02 |          0.20 |     78.21 | \-1.17950e+02 |       \-76.70 |        \-4.50 |         71.23 | 1.349000e+02 | ▇▃▅▃▅ |
| stddev\_yaw\_dumbbell      |      19216 |           0.02 |         16.65 |     17.71 |   0.00000e+00 |          3.88 |         10.26 |         24.67 | 1.070900e+02 | ▇▂▁▁▁ |
| var\_yaw\_dumbbell         |      19216 |           0.02 |        589.84 |   1244.59 |   0.00000e+00 |         15.09 |        105.35 |        608.79 | 1.146791e+04 | ▇▁▁▁▁ |
| gyros\_dumbbell\_x         |          0 |           1.00 |          0.16 |      1.51 | \-2.04000e+02 |        \-0.03 |          0.13 |          0.35 | 2.220000e+00 | ▁▁▁▁▇ |
| gyros\_dumbbell\_y         |          0 |           1.00 |          0.05 |      0.61 | \-2.10000e+00 |        \-0.14 |          0.03 |          0.21 | 5.200000e+01 | ▇▁▁▁▁ |
| gyros\_dumbbell\_z         |          0 |           1.00 |        \-0.13 |      2.29 | \-2.38000e+00 |        \-0.31 |        \-0.13 |          0.03 | 3.170000e+02 | ▇▁▁▁▁ |
| accel\_dumbbell\_x         |          0 |           1.00 |       \-28.62 |     67.32 | \-4.19000e+02 |       \-50.00 |        \-8.00 |         11.00 | 2.350000e+02 | ▁▁▆▇▁ |
| accel\_dumbbell\_y         |          0 |           1.00 |         52.63 |     80.75 | \-1.89000e+02 |        \-8.00 |         41.50 |        111.00 | 3.150000e+02 | ▁▇▇▅▁ |
| accel\_dumbbell\_z         |          0 |           1.00 |       \-38.32 |    109.47 | \-3.34000e+02 |      \-142.00 |        \-1.00 |         38.00 | 3.180000e+02 | ▁▆▇▃▁ |
| magnet\_dumbbell\_x        |          0 |           1.00 |      \-328.48 |    339.72 | \-6.43000e+02 |      \-535.00 |      \-479.00 |      \-304.00 | 5.920000e+02 | ▇▂▁▁▂ |
| magnet\_dumbbell\_y        |          0 |           1.00 |        220.97 |    326.87 | \-3.60000e+03 |        231.00 |        311.00 |        390.00 | 6.330000e+02 | ▁▁▁▁▇ |
| magnet\_dumbbell\_z        |          0 |           1.00 |         46.05 |    139.96 | \-2.62000e+02 |       \-45.00 |         13.00 |         95.00 | 4.520000e+02 | ▁▇▆▂▂ |
| roll\_forearm              |          0 |           1.00 |         33.83 |    108.04 | \-1.80000e+02 |        \-0.74 |         21.70 |        140.00 | 1.800000e+02 | ▃▂▇▂▇ |
| pitch\_forearm             |          0 |           1.00 |         10.71 |     28.15 | \-7.25000e+01 |          0.00 |          9.24 |         28.40 | 8.980000e+01 | ▁▁▇▃▁ |
| yaw\_forearm               |          0 |           1.00 |         19.21 |    103.22 | \-1.80000e+02 |       \-68.60 |          0.00 |        110.00 | 1.800000e+02 | ▅▅▇▆▇ |
| max\_roll\_forearm         |      19216 |           0.02 |         24.49 |     31.04 | \-6.66000e+01 |          0.00 |         26.80 |         45.95 | 8.980000e+01 | ▁▁▇▇▂ |
| max\_picth\_forearm        |      19216 |           0.02 |         81.49 |     95.54 | \-1.51000e+02 |          0.00 |        113.00 |        174.75 | 1.800000e+02 | ▁▂▃▂▇ |
| min\_roll\_forearm         |      19216 |           0.02 |        \-0.17 |     22.59 | \-7.25000e+01 |        \-6.07 |          0.00 |         12.07 | 6.210000e+01 | ▁▁▇▃▁ |
| min\_pitch\_forearm        |      19216 |           0.02 |       \-57.57 |    110.74 | \-1.80000e+02 |      \-175.00 |       \-61.00 |          0.00 | 1.670000e+02 | ▇▂▅▂▂ |
| amplitude\_roll\_forearm   |      19216 |           0.02 |         24.65 |     25.88 |   0.00000e+00 |          1.12 |         17.77 |         39.88 | 1.260000e+02 | ▇▃▂▁▁ |
| amplitude\_pitch\_forearm  |      19216 |           0.02 |        139.06 |    147.86 |   0.00000e+00 |          2.00 |         83.70 |        350.00 | 3.600000e+02 | ▇▃▁▁▅ |
| total\_accel\_forearm      |          0 |           1.00 |         34.72 |     10.06 |   0.00000e+00 |         29.00 |         36.00 |         41.00 | 1.080000e+02 | ▁▇▂▁▁ |
| var\_accel\_forearm        |      19216 |           0.02 |         33.50 |     33.95 |   0.00000e+00 |          6.76 |         21.16 |         51.24 | 1.726100e+02 | ▇▃▂▁▁ |
| avg\_roll\_forearm         |      19216 |           0.02 |         33.17 |     79.52 | \-1.77230e+02 |        \-0.91 |         11.17 |        107.13 | 1.772600e+02 | ▁▂▇▃▅ |
| stddev\_roll\_forearm      |      19216 |           0.02 |         41.99 |     59.33 |   0.00000e+00 |          0.43 |          8.03 |         85.37 | 1.791700e+02 | ▇▁▁▁▂ |
| var\_roll\_forearm         |      19216 |           0.02 |       5274.10 |   9177.18 |   0.00000e+00 |          0.18 |         64.48 |       7289.08 | 3.210224e+04 | ▇▁▁▁▁ |
| avg\_pitch\_forearm        |      19216 |           0.02 |         11.80 |     24.83 | \-6.81700e+01 |          0.00 |         12.02 |         28.48 | 7.209000e+01 | ▁▁▇▆▁ |
| stddev\_pitch\_forearm     |      19216 |           0.02 |          7.98 |      8.73 |   0.00000e+00 |          0.34 |          5.52 |         12.87 | 4.775000e+01 | ▇▃▁▁▁ |
| var\_pitch\_forearm        |      19216 |           0.02 |        139.59 |    266.49 |   0.00000e+00 |          0.11 |         30.43 |        165.53 | 2.279620e+03 | ▇▁▁▁▁ |
| avg\_yaw\_forearm          |      19216 |           0.02 |         18.00 |     77.56 | \-1.55060e+02 |       \-26.26 |          0.00 |         85.79 | 1.692400e+02 | ▂▃▇▆▃ |
| stddev\_yaw\_forearm       |      19216 |           0.02 |         44.85 |     51.33 |   0.00000e+00 |          0.52 |         24.74 |         85.82 | 1.975100e+02 | ▇▂▂▂▁ |
| var\_yaw\_forearm          |      19216 |           0.02 |       4639.85 |   7284.97 |   0.00000e+00 |          0.27 |        612.21 |       7368.41 | 3.900933e+04 | ▇▂▁▁▁ |
| gyros\_forearm\_x          |          0 |           1.00 |          0.16 |      0.65 | \-2.20000e+01 |        \-0.22 |          0.05 |          0.56 | 3.970000e+00 | ▁▁▁▁▇ |
| gyros\_forearm\_y          |          0 |           1.00 |          0.08 |      3.10 | \-7.02000e+00 |        \-1.46 |          0.03 |          1.62 | 3.110000e+02 | ▇▁▁▁▁ |
| gyros\_forearm\_z          |          0 |           1.00 |          0.15 |      1.75 | \-8.09000e+00 |        \-0.18 |          0.08 |          0.49 | 2.310000e+02 | ▇▁▁▁▁ |
| accel\_forearm\_x          |          0 |           1.00 |       \-61.65 |    180.59 | \-4.98000e+02 |      \-178.00 |       \-57.00 |         76.00 | 4.770000e+02 | ▂▆▇▅▁ |
| accel\_forearm\_y          |          0 |           1.00 |        163.66 |    200.13 | \-6.32000e+02 |         57.00 |        201.00 |        312.00 | 9.230000e+02 | ▁▂▇▅▁ |
| accel\_forearm\_z          |          0 |           1.00 |       \-55.29 |    138.40 | \-4.46000e+02 |      \-182.00 |       \-39.00 |         26.00 | 2.910000e+02 | ▁▇▅▅▃ |
| magnet\_forearm\_x         |          0 |           1.00 |      \-312.58 |    346.96 | \-1.28000e+03 |      \-616.00 |      \-378.00 |       \-73.00 | 6.720000e+02 | ▁▇▇▅▁ |
| magnet\_forearm\_y         |          0 |           1.00 |        380.12 |    509.37 | \-8.96000e+02 |          2.00 |        591.00 |        737.00 | 1.480000e+03 | ▂▂▂▇▁ |
| magnet\_forearm\_z         |          0 |           1.00 |        393.61 |    369.27 | \-9.73000e+02 |        191.00 |        511.00 |        653.00 | 1.090000e+03 | ▁▁▂▇▃ |

``` r
#explore the missing value impacts
#select missing data
missing_data <- data_raw %>%
  select_if(~ any(is.na(.)))

missing_data %>% 
  gg_miss_upset()
```

![](predict_activity_no_tune_files/figure-gfm/unnamed-chunk-1-1.png)<!-- -->

``` r
# eliminate the variables with the missing data in training data
data_clean <- data_raw %>%
  select_if(~ !any(is.na(.))) %>% 
  select(-cvtd_timestamp, -new_window, -X1, -raw_timestamp_part_1, -raw_timestamp_part_2, -num_window)

data_clean$classe <- as.factor(data_clean$classe)

# eliminate the variables with the missing data in testing data
valid_clean <- valid_raw %>%
  select_if(~ !any(is.na(.))) %>% 
  select(-user_name, -cvtd_timestamp, -new_window, -X1, -raw_timestamp_part_1, -raw_timestamp_part_2, -num_window, -problem_id)


# narrow in on the reduced data set
skim(data_clean)
```

|                                                  |             |
| :----------------------------------------------- | :---------- |
| Name                                             | data\_clean |
| Number of rows                                   | 19622       |
| Number of columns                                | 54          |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_   |             |
| Column type frequency:                           |             |
| character                                        | 1           |
| factor                                           | 1           |
| numeric                                          | 52          |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ |             |
| Group variables                                  | None        |

Data summary

**Variable type:
character**

| skim\_variable | n\_missing | complete\_rate | min | max | empty | n\_unique | whitespace |
| :------------- | ---------: | -------------: | --: | --: | ----: | --------: | ---------: |
| user\_name     |          0 |              1 |   5 |   8 |     0 |         6 |          0 |

**Variable type:
factor**

| skim\_variable | n\_missing | complete\_rate | ordered | n\_unique | top\_counts                        |
| :------------- | ---------: | -------------: | :------ | --------: | :--------------------------------- |
| classe         |          0 |              1 | FALSE   |         5 | A: 5580, B: 3797, E: 3607, C: 3422 |

**Variable type:
numeric**

| skim\_variable         | n\_missing | complete\_rate |     mean |     sd |        p0 |      p25 |      p50 |      p75 |    p100 | hist  |
| :--------------------- | ---------: | -------------: | -------: | -----: | --------: | -------: | -------: | -------: | ------: | :---- |
| roll\_belt             |          0 |              1 |    64.41 |  62.75 |   \-28.90 |     1.10 |   113.00 |   123.00 |  162.00 | ▇▁▁▅▅ |
| pitch\_belt            |          0 |              1 |     0.31 |  22.35 |   \-55.80 |     1.76 |     5.28 |    14.90 |   60.30 | ▃▁▇▅▁ |
| yaw\_belt              |          0 |              1 |  \-11.21 |  95.19 |  \-180.00 |  \-88.30 |  \-13.00 |    12.90 |  179.00 | ▁▇▅▁▃ |
| total\_accel\_belt     |          0 |              1 |    11.31 |   7.74 |      0.00 |     3.00 |    17.00 |    18.00 |   29.00 | ▇▁▂▆▁ |
| gyros\_belt\_x         |          0 |              1 |   \-0.01 |   0.21 |    \-1.04 |   \-0.03 |     0.03 |     0.11 |    2.22 | ▁▇▁▁▁ |
| gyros\_belt\_y         |          0 |              1 |     0.04 |   0.08 |    \-0.64 |     0.00 |     0.02 |     0.11 |    0.64 | ▁▁▇▁▁ |
| gyros\_belt\_z         |          0 |              1 |   \-0.13 |   0.24 |    \-1.46 |   \-0.20 |   \-0.10 |   \-0.02 |    1.62 | ▁▂▇▁▁ |
| accel\_belt\_x         |          0 |              1 |   \-5.59 |  29.64 |  \-120.00 |  \-21.00 |  \-15.00 |   \-5.00 |   85.00 | ▁▁▇▁▂ |
| accel\_belt\_y         |          0 |              1 |    30.15 |  28.58 |   \-69.00 |     3.00 |    35.00 |    61.00 |  164.00 | ▁▇▇▁▁ |
| accel\_belt\_z         |          0 |              1 |  \-72.59 | 100.45 |  \-275.00 | \-162.00 | \-152.00 |    27.00 |  105.00 | ▁▇▁▅▃ |
| magnet\_belt\_x        |          0 |              1 |    55.60 |  64.18 |   \-52.00 |     9.00 |    35.00 |    59.00 |  485.00 | ▇▁▂▁▁ |
| magnet\_belt\_y        |          0 |              1 |   593.68 |  35.68 |    354.00 |   581.00 |   601.00 |   610.00 |  673.00 | ▁▁▁▇▃ |
| magnet\_belt\_z        |          0 |              1 | \-345.48 |  65.21 |  \-623.00 | \-375.00 | \-320.00 | \-306.00 |  293.00 | ▁▇▁▁▁ |
| roll\_arm              |          0 |              1 |    17.83 |  72.74 |  \-180.00 |  \-31.78 |     0.00 |    77.30 |  180.00 | ▁▃▇▆▂ |
| pitch\_arm             |          0 |              1 |   \-4.61 |  30.68 |   \-88.80 |  \-25.90 |     0.00 |    11.20 |   88.50 | ▁▅▇▂▁ |
| yaw\_arm               |          0 |              1 |   \-0.62 |  71.36 |  \-180.00 |  \-43.10 |     0.00 |    45.88 |  180.00 | ▁▃▇▃▂ |
| total\_accel\_arm      |          0 |              1 |    25.51 |  10.52 |      1.00 |    17.00 |    27.00 |    33.00 |   66.00 | ▃▆▇▁▁ |
| gyros\_arm\_x          |          0 |              1 |     0.04 |   1.99 |    \-6.37 |   \-1.33 |     0.08 |     1.57 |    4.87 | ▁▃▇▆▂ |
| gyros\_arm\_y          |          0 |              1 |   \-0.26 |   0.85 |    \-3.44 |   \-0.80 |   \-0.24 |     0.14 |    2.84 | ▁▂▇▂▁ |
| gyros\_arm\_z          |          0 |              1 |     0.27 |   0.55 |    \-2.33 |   \-0.07 |     0.23 |     0.72 |    3.02 | ▁▂▇▂▁ |
| accel\_arm\_x          |          0 |              1 |  \-60.24 | 182.04 |  \-404.00 | \-242.00 |  \-44.00 |    84.00 |  437.00 | ▇▅▇▅▁ |
| accel\_arm\_y          |          0 |              1 |    32.60 | 109.87 |  \-318.00 |  \-54.00 |    14.00 |   139.00 |  308.00 | ▁▃▇▆▂ |
| accel\_arm\_z          |          0 |              1 |  \-71.25 | 134.65 |  \-636.00 | \-143.00 |  \-47.00 |    23.00 |  292.00 | ▁▁▅▇▁ |
| magnet\_arm\_x         |          0 |              1 |   191.72 | 443.64 |  \-584.00 | \-300.00 |   289.00 |   637.00 |  782.00 | ▆▃▂▃▇ |
| magnet\_arm\_y         |          0 |              1 |   156.61 | 201.91 |  \-392.00 |   \-9.00 |   202.00 |   323.00 |  583.00 | ▁▅▅▇▂ |
| magnet\_arm\_z         |          0 |              1 |   306.49 | 326.62 |  \-597.00 |   131.25 |   444.00 |   545.00 |  694.00 | ▁▂▂▃▇ |
| roll\_dumbbell         |          0 |              1 |    23.84 |  69.93 |  \-153.71 |  \-18.49 |    48.17 |    67.61 |  153.55 | ▂▂▃▇▂ |
| pitch\_dumbbell        |          0 |              1 |  \-10.78 |  36.99 |  \-149.59 |  \-40.89 |  \-20.96 |    17.50 |  149.40 | ▁▆▇▂▁ |
| yaw\_dumbbell          |          0 |              1 |     1.67 |  82.52 |  \-150.87 |  \-77.64 |   \-3.32 |    79.64 |  154.95 | ▃▇▅▅▆ |
| total\_accel\_dumbbell |          0 |              1 |    13.72 |  10.23 |      0.00 |     4.00 |    10.00 |    19.00 |   58.00 | ▇▅▃▁▁ |
| gyros\_dumbbell\_x     |          0 |              1 |     0.16 |   1.51 |  \-204.00 |   \-0.03 |     0.13 |     0.35 |    2.22 | ▁▁▁▁▇ |
| gyros\_dumbbell\_y     |          0 |              1 |     0.05 |   0.61 |    \-2.10 |   \-0.14 |     0.03 |     0.21 |   52.00 | ▇▁▁▁▁ |
| gyros\_dumbbell\_z     |          0 |              1 |   \-0.13 |   2.29 |    \-2.38 |   \-0.31 |   \-0.13 |     0.03 |  317.00 | ▇▁▁▁▁ |
| accel\_dumbbell\_x     |          0 |              1 |  \-28.62 |  67.32 |  \-419.00 |  \-50.00 |   \-8.00 |    11.00 |  235.00 | ▁▁▆▇▁ |
| accel\_dumbbell\_y     |          0 |              1 |    52.63 |  80.75 |  \-189.00 |   \-8.00 |    41.50 |   111.00 |  315.00 | ▁▇▇▅▁ |
| accel\_dumbbell\_z     |          0 |              1 |  \-38.32 | 109.47 |  \-334.00 | \-142.00 |   \-1.00 |    38.00 |  318.00 | ▁▆▇▃▁ |
| magnet\_dumbbell\_x    |          0 |              1 | \-328.48 | 339.72 |  \-643.00 | \-535.00 | \-479.00 | \-304.00 |  592.00 | ▇▂▁▁▂ |
| magnet\_dumbbell\_y    |          0 |              1 |   220.97 | 326.87 | \-3600.00 |   231.00 |   311.00 |   390.00 |  633.00 | ▁▁▁▁▇ |
| magnet\_dumbbell\_z    |          0 |              1 |    46.05 | 139.96 |  \-262.00 |  \-45.00 |    13.00 |    95.00 |  452.00 | ▁▇▆▂▂ |
| roll\_forearm          |          0 |              1 |    33.83 | 108.04 |  \-180.00 |   \-0.74 |    21.70 |   140.00 |  180.00 | ▃▂▇▂▇ |
| pitch\_forearm         |          0 |              1 |    10.71 |  28.15 |   \-72.50 |     0.00 |     9.24 |    28.40 |   89.80 | ▁▁▇▃▁ |
| yaw\_forearm           |          0 |              1 |    19.21 | 103.22 |  \-180.00 |  \-68.60 |     0.00 |   110.00 |  180.00 | ▅▅▇▆▇ |
| total\_accel\_forearm  |          0 |              1 |    34.72 |  10.06 |      0.00 |    29.00 |    36.00 |    41.00 |  108.00 | ▁▇▂▁▁ |
| gyros\_forearm\_x      |          0 |              1 |     0.16 |   0.65 |   \-22.00 |   \-0.22 |     0.05 |     0.56 |    3.97 | ▁▁▁▁▇ |
| gyros\_forearm\_y      |          0 |              1 |     0.08 |   3.10 |    \-7.02 |   \-1.46 |     0.03 |     1.62 |  311.00 | ▇▁▁▁▁ |
| gyros\_forearm\_z      |          0 |              1 |     0.15 |   1.75 |    \-8.09 |   \-0.18 |     0.08 |     0.49 |  231.00 | ▇▁▁▁▁ |
| accel\_forearm\_x      |          0 |              1 |  \-61.65 | 180.59 |  \-498.00 | \-178.00 |  \-57.00 |    76.00 |  477.00 | ▂▆▇▅▁ |
| accel\_forearm\_y      |          0 |              1 |   163.66 | 200.13 |  \-632.00 |    57.00 |   201.00 |   312.00 |  923.00 | ▁▂▇▅▁ |
| accel\_forearm\_z      |          0 |              1 |  \-55.29 | 138.40 |  \-446.00 | \-182.00 |  \-39.00 |    26.00 |  291.00 | ▁▇▅▅▃ |
| magnet\_forearm\_x     |          0 |              1 | \-312.58 | 346.96 | \-1280.00 | \-616.00 | \-378.00 |  \-73.00 |  672.00 | ▁▇▇▅▁ |
| magnet\_forearm\_y     |          0 |              1 |   380.12 | 509.37 |  \-896.00 |     2.00 |   591.00 |   737.00 | 1480.00 | ▂▂▂▇▁ |
| magnet\_forearm\_z     |          0 |              1 |   393.61 | 369.27 |  \-973.00 |   191.00 |   511.00 |   653.00 | 1090.00 | ▁▁▂▇▃ |

``` r
#train <- as_tibble(train)
#glimpse(train)

data_clean %>% 
  count(classe) %>% 
  mutate(prop = n/sum(n))
```

    ## # A tibble: 5 x 3
    ##   classe     n  prop
    ##   <fct>  <int> <dbl>
    ## 1 A       5580 0.284
    ## 2 B       3797 0.194
    ## 3 C       3422 0.174
    ## 4 D       3216 0.164
    ## 5 E       3607 0.184

``` r
##Explore the numeric correlations. 
all_numeric <- select_if(data_clean, is.numeric)

cor_threshold <- 0.8
correlate(all_numeric) %>% 
  stretch() %>% 
  mutate(threshold = case_when(r > cor_threshold | r < -cor_threshold ~ 1,
                          TRUE ~ 0)) %>%
  count(threshold)
```

    ## 
    ## Correlation method: 'pearson'
    ## Missing treated using: 'pairwise.complete.obs'

    ## # A tibble: 2 x 2
    ##   threshold     n
    ##       <dbl> <int>
    ## 1         0  2666
    ## 2         1    38

``` r
cor <- correlate(all_numeric) %>% 
  stretch() %>% 
  filter(r > cor_threshold | r < -cor_threshold, r != 1) %>% 
  arrange(desc(r))
```

    ## 
    ## Correlation method: 'pearson'
    ## Missing treated using: 'pairwise.complete.obs'

``` r
high_cor <- all_numeric %>% 
  select(as.character(cor$x))

high_cor %>% 
  correlate() %>% 
  rearrange(method = "MDS", absolute = FALSE) %>% 
  shave() %>% 
  rplot(shape = 19, colors = c("red", "green"))
```

    ## 
    ## Correlation method: 'pearson'
    ## Missing treated using: 'pairwise.complete.obs'

    ## Registered S3 method overwritten by 'seriation':
    ##   method         from 
    ##   reorder.hclust gclus

    ## Don't know how to automatically pick scale for object of type noquote. Defaulting to continuous.

![](predict_activity_no_tune_files/figure-gfm/unnamed-chunk-1-2.png)<!-- -->

``` r
# explore k-means clusters 
# select variables we want to cluster on
points <- data_clean %>% 
  select(-classe, -user_name)

#explore the number of clusters
kclusts <- 
  tibble(k = 1:20) %>%
  mutate(
    kclust = map(k, ~kmeans(points, .x)),
    tidied = map(kclust, tidy),
    glanced = map(kclust, glance),
    augmented = map(kclust, augment, points)
  )
# assign separate lists
clusters <- 
  kclusts %>%
  unnest(cols = c(tidied))

assignments <- 
  kclusts %>% 
  unnest(cols = c(augmented))

clusterings <- 
  kclusts %>%
  unnest(cols = c(glanced))

#find best number of clusters
ggplot(clusterings, aes(k, tot.withinss)) +
  geom_line() +
  geom_point()
```

![](predict_activity_no_tune_files/figure-gfm/unnamed-chunk-1-3.png)<!-- -->
\# Split the training and testing sets and set up cross validation

``` r
set.seed(123)
data_split <- initial_split(data_clean, strata = classe)
train <- training(data_split)
test <- testing(data_split)
# create the cross validation sets
vfolds <- vfold_cv(train, v = 3, strata = classe) # 3 folds
```

# Fit a xgboost model

``` r
# Build xgboost specification
xgb_spec <- boost_tree() %>% 
        set_engine("xgboost") %>% 
        set_mode("classification")
# Build the xgboost workflow
# we don't need a recipe. We will use all the data
xgb_wf <- workflow() %>% 
        add_formula(classe ~ .) %>% 
        add_model(xgb_spec)
```

## Fit the xgboost model

``` r
set.seed(234)

#fit on 3 folds
xgb_result <- fit_resamples(
  xgb_wf,
  resamples = vfolds,
  control = control_resamples(save_pred = TRUE)
)
# explore the results
xgb_result %>% 
  collect_metrics()
```

    ## # A tibble: 2 x 5
    ##   .metric  .estimator  mean     n   std_err
    ##   <chr>    <chr>      <dbl> <int>     <dbl>
    ## 1 accuracy multiclass 0.969     3 0.00180  
    ## 2 roc_auc  hand_till  0.998     3 0.0000860

``` r
# create a confusion matrix
xgb_result %>% 
  collect_predictions() %>% 
  conf_mat(classe, .pred_class)
```

    ##           Truth
    ## Prediction    A    B    C    D    E
    ##          A 4136   71    1    6    1
    ##          B   28 2697   66    6   23
    ##          C   14   69 2464   59   15
    ##          D    3    7   35 2330   30
    ##          E    4    4    1   11 2637

``` r
final_model <- xgb_wf %>% 
        fit(data = (train %>% select(-user_name))) %>% 
        pull_workflow_fit()
```

# Test Predictions

``` r
predictions <- 
  predict(final_model, new_data = valid_clean)
```
